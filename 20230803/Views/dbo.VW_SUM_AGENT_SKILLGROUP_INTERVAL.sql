SET ANSI_NULLS ON
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[VW_SUM_AGENT_SKILLGROUP_INTERVAL]
AS
SELECT  [SUMMARIZED_URN],
        [DATE_URN],
        [TIME_URN],
        [DATE_UTC_URN],
        [TIME_UTC_URN],
        [AGENT_URN],
        [SKILLGROUP_URN],
        [AGENT_TEAM_URN],
        [SUPERVISOR_AGENT_URN],
        [PERIPHERAL_URN],
        [PERSON_URN],
        [CLUSTER_RESOURCE_URN],
        [DATE_TIME],
        [TIME_ZONE],
        [ABANDON_RING_CALLS],
        [ABANDON_RING_TIME],
        [ABANDON_HOLD_CALLS],
        [AGENT_OUT_CALLS_TIME],
        [AGENT_OUT_CALLS_TALK_TIME],
        [AGENT_OUT_CALLS],
        [AGENT_OUT_CALLS_ON_HOLD],
        [AGENT_OUT_CALLS_ON_HOLD_TIME],
        [AGENT_TERMINATED_CALLS],
        [ANSWER_WAIT_TIME],
        [AVAIL_TIME],
        [BUSY_OTHER_TIME],
        [CALLBACK_MESSAGES_TIME],
        [CALLBACK_MESSAGES],
        [CALLS_ANSWERED],
        [CALLS_HANDLED],
        [CONSULTATIVE_CALLS],
        [CONSULTATIVE_CALLS_TIME],
        [CONFERENCED_IN_CALLS],
        [CONFERENCED_IN_CALLS_TIME],
        [CONFERENCED_OUT_CALLS],
        [CONFERENCED_OUT_CALLS_TIME],
        [HANDLED_CALLS_TALK_TIME],
        [HANDLED_CALLS_TIME],
        [HOLD_TIME],
        [INCOMING_CALLS_ON_HOLD_TIME],
        [INCOMING_CALLS_ON_HOLD],
        [INTERNAL_CALLS_ON_HOLD_TIME],
        [INTERNAL_CALLS_ON_HOLD],
        [INTERNAL_CALLS_RCVD_TIME],
        [INTERNAL_CALLS_RCVD],
        [INTERNAL_CALLS_TIME],
        [INTERNAL_CALLS],
        [LOGGED_ON_TIME],
        [NOT_READY_TIME],
        [REDIRECT_NO_ANS_CALLS],
        [REDIRECT_NO_ANS_CALLS_TIME],
        [RESERVED_STATE_TIME],
        [SHORT_CALLS],
        [SUPERV_ASSIST_CALLS_TIME],
        [SUPERV_ASSIST_CALLS],
        [TALK_IN_TIME],
        [TALK_OTHER_TIME],
        [TALK_OUT_TIME],
        [TRANSFERRED_IN_CALLS_TIME],
        [TRANSFERRED_IN_CALLS],
        [TRANSFERRED_OUT_CALLS],
        [WORK_NOT_READY_TIME],
        [WORK_READY_TIME],
        [AUTO_OUT_CALLS],
        [AUTO_OUT_CALLS_TIME],
        [AUTO_OUT_CALLS_TALK_TIME],
        [AUTO_OUT_CALLS_ON_HOLD],
        [AUTO_OUT_CALLS_ON_HOLD_TIME],
        [PREVIEW_CALLS],
        [PREVIEW_CALLS_TIME],
        [PREVIEW_CALLS_TALK_TIME],
        [PREVIEW_CALLS_ON_HOLD],
        [PREVIEW_CALLS_ON_HOLD_TIME],
        [RESERVE_CALLS],
        [RESERVE_CALLS_TIME],
        [RESERVE_CALLS_TALK_TIME],
        [RESERVE_CALLS_ON_HOLD],
        [RESERVE_CALLS_ON_HOLD_TIME],
        [TALK_AUTO_OUT_TIME],
        [TALK_PREVIEW_TIME],
        [TALK_RESERVE_TIME],
        [BARGE_IN_CALLS],
        [INTERCEPT_CALLS],
        [MONITOR_CALLS],
        [WHISPER_CALLS],
        [EMERGENCY_ASSISTS],
        [ABANDON_HOLD_OUT_CALLS],
        [NET_CONFERENCED_OUT_CALLS_TIME],
        [NET_CONFERENCED_OUT_CALLS],
        [NET_CONSULTATIVE_CALLS_TIME],
        [NET_CONSULTATIVE_CALLS],
        [NET_TRANSFERED_OUT_CALLS],
        [CONSULT_OUT_CALLS],
        [CONSULT_OUT_CALLS_TIME],
        [INTERRUPTED_TIME],
        [REPORTING_HALF_HOUR],
        [REPORTING_INTERVAL],
        ( CAST([TALK_IN_TIME] AS BIGINT) + CAST([TALK_OUT_TIME] AS BIGINT) + CAST([HOLD_TIME] AS BIGINT) + CAST([WORK_READY_TIME] AS BIGINT)
          + CAST([WORK_NOT_READY_TIME] AS BIGINT) ) AS [CALL_TIME_TOTAL],
        ( CAST([TALK_IN_TIME] AS BIGINT) + CAST([TALK_OUT_TIME] AS BIGINT) + CAST([HOLD_TIME] AS BIGINT) + CAST([WORK_READY_TIME] AS BIGINT)
          + CAST([WORK_NOT_READY_TIME] AS BIGINT) + CAST([NOT_READY_TIME] AS BIGINT) ) AS [OCCUPANCY_TIME],
        ( CAST([HANDLED_CALLS_TALK_TIME] AS BIGINT) + CAST([INCOMING_CALLS_ON_HOLD_TIME] AS BIGINT) ) AS [PHONE_TIME_IN],
        ( CAST([AGENT_OUT_CALLS_TALK_TIME] AS BIGINT) + CAST([AGENT_OUT_CALLS_ON_HOLD_TIME] AS BIGINT) ) AS [PHONE_TIME_OUT],
        ( CAST([HANDLED_CALLS_TALK_TIME] AS BIGINT) + CAST([INCOMING_CALLS_ON_HOLD_TIME] AS BIGINT)
          + CAST([AGENT_OUT_CALLS_TALK_TIME] AS BIGINT) + CAST([AGENT_OUT_CALLS_ON_HOLD_TIME] AS BIGINT) ) AS [PHONE_TIME_TOTAL],
        ( CAST([CALLS_HANDLED] AS BIGINT) + CAST([AGENT_OUT_CALLS] AS BIGINT) ) AS [CALL_HANDLED_TOTAL], -- Denominator for [Avg Phone Time Total]
        ( CAST([TRANSFERRED_OUT_CALLS] AS BIGINT) + CAST([NET_TRANSFERED_OUT_CALLS] AS BIGINT) ) AS [TRANSFERRED_OUT_TOTAL],
        ( CAST([TALK_IN_TIME] AS BIGINT) + CAST([TALK_OUT_TIME] AS BIGINT) ) AS [TALK_TIME],
        ( CAST([WORK_READY_TIME] AS BIGINT) + CAST([WORK_NOT_READY_TIME] AS BIGINT) ) AS [WRAP_TIME],
        [PARTITION_ID],
        [PRECISION_QUEUE_URN],
        [PRECISION_ATTRIBUTE_URN_1],
        [PRECISION_ATTRIBUTE_URN_2],
        [PRECISION_ATTRIBUTE_URN_3],
        [PRECISION_ATTRIBUTE_URN_4],
        [PRECISION_ATTRIBUTE_URN_5],
        [PRECISION_ATTRIBUTE_URN_6],
        [PRECISION_ATTRIBUTE_URN_7],
        [PRECISION_ATTRIBUTE_URN_8],
        [PRECISION_ATTRIBUTE_URN_9],
        [PRECISION_ATTRIBUTE_URN_10],
        [MEDIA_CLASS_URN],
        [MEDIA_ROUTING_DOMAIN_URN],
        1 AS [Row Count]
FROM    dbo.VW_PARTITIONED_SUM_AGENT_SKILLGROUP_INTERVAL;
GO
GRANT SELECT
	ON [dbo].[VW_SUM_AGENT_SKILLGROUP_INTERVAL]
	TO [portalreporting_role]
GO
