SET ANSI_NULLS ON
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[VW_SUM_ROUTER_QUEUE_INTERVAL]
AS
SELECT  [PARTITION_URN],
        [PARTITION_ID],
        [PARTITION_GLOBAL_URN],
        [DATE_TIME],
        [TIME_ZONE],
        [DATE_URN],
        [TIME_URN],
        [DATE_UTC_URN],
        [TIME_UTC_URN],
        [PRECISION_QUEUE_URN],
        [MEDIA_CLASS_URN],
        [MEDIA_ROUTING_DOMAIN_URN],
        [BUCKET_INTERVAL_URN],
        [CLUSTER_RESOURCE_URN],
        [CALLS_ABAND_DEQUEUED],
        [CALLS_ABAND_Q],
        [CALLS_ABAND_TO_AGENT],
        [CALLS_ANSWERED],
        [CALLS_DEQUEUED],
        [CALLS_OFFERED],
        [DELAY_Q_ABAND_TIME],
        [MAX_CALLS_QUEUED],
        [MAX_CALL_WAIT_TIME],
        [QUEUE_CALLS],
        [ROUTED_TO_AGENT],
        [ROUTER_ERROR],
        [SERVICE_LEVEL],
        [SERVICE_LEVEL_CALLS],
        [SERVICE_LEVEL_CALLS_ABAND],
        [SERVICE_LEVEL_CALLS_DEQUEUE],
        [SERVICE_LEVEL_CALLS_OFFERED],
        d.[SERVICE_LEVEL_TYPE],
        [SERVICE_LEVEL_ERROR],
        [SERVICE_LEVEL_RONA],
        [ABAND_INTERVAL_1],
        [ABAND_INTERVAL_2],
        [ABAND_INTERVAL_3],
        [ABAND_INTERVAL_4],
        [ABAND_INTERVAL_5],
        [ABAND_INTERVAL_6],
        [ABAND_INTERVAL_7],
        [ABAND_INTERVAL_8],
        [ABAND_INTERVAL_9],
        [ABAND_INTERVAL_10],
        [ANS_INTERVAL_1],
        [ANS_INTERVAL_2],
        [ANS_INTERVAL_3],
        [ANS_INTERVAL_4],
        [ANS_INTERVAL_5],
        [ANS_INTERVAL_6],
        [ANS_INTERVAL_7],
        [ANS_INTERVAL_8],
        [ANS_INTERVAL_9],
        [ANS_INTERVAL_10],
        [PRECISION_ATTRIBUTE_URN_1],
        [PRECISION_ATTRIBUTE_URN_2],
        [PRECISION_ATTRIBUTE_URN_3],
        [PRECISION_ATTRIBUTE_URN_4],
        [PRECISION_ATTRIBUTE_URN_5],
        [PRECISION_ATTRIBUTE_URN_6],
        [PRECISION_ATTRIBUTE_URN_7],
        [PRECISION_ATTRIBUTE_URN_8],
        [PRECISION_ATTRIBUTE_URN_9],
        [PRECISION_ATTRIBUTE_URN_10],
        [ABAND_PRECISION_QUEUE_STEP_1],
        [ABAND_PRECISION_QUEUE_STEP_2],
        [ABAND_PRECISION_QUEUE_STEP_3],
        [ABAND_PRECISION_QUEUE_STEP_4],
        [ABAND_PRECISION_QUEUE_STEP_5],
        [ABAND_PRECISION_QUEUE_STEP_6],
        [ABAND_PRECISION_QUEUE_STEP_7],
        [ABAND_PRECISION_QUEUE_STEP_8],
        [ABAND_PRECISION_QUEUE_STEP_9],
        [ABAND_PRECISION_QUEUE_STEP_10],
        [ANS_PRECISION_QUEUE_STEP_1],
        [ANS_PRECISION_QUEUE_STEP_2],
        [ANS_PRECISION_QUEUE_STEP_3],
        [ANS_PRECISION_QUEUE_STEP_4],
        [ANS_PRECISION_QUEUE_STEP_5],
        [ANS_PRECISION_QUEUE_STEP_6],
        [ANS_PRECISION_QUEUE_STEP_7],
        [ANS_PRECISION_QUEUE_STEP_8],
        [ANS_PRECISION_QUEUE_STEP_9],
        [ANS_PRECISION_QUEUE_STEP_10],
        [OFFERED_PRECISION_QUEUE_STEP_1],
        [OFFERED_PRECISION_QUEUE_STEP_2],
        [OFFERED_PRECISION_QUEUE_STEP_3],
        [OFFERED_PRECISION_QUEUE_STEP_4],
        [OFFERED_PRECISION_QUEUE_STEP_5],
        [OFFERED_PRECISION_QUEUE_STEP_6],
        [OFFERED_PRECISION_QUEUE_STEP_7],
        [OFFERED_PRECISION_QUEUE_STEP_8],
        [OFFERED_PRECISION_QUEUE_STEP_9],
        [OFFERED_PRECISION_QUEUE_STEP_10],
        [SKIP_PRECISION_QUEUE_STEP_1],
        [SKIP_PRECISION_QUEUE_STEP_2],
        [SKIP_PRECISION_QUEUE_STEP_3],
        [SKIP_PRECISION_QUEUE_STEP_4],
        [SKIP_PRECISION_QUEUE_STEP_5],
        [SKIP_PRECISION_QUEUE_STEP_6],
        [SKIP_PRECISION_QUEUE_STEP_7],
        [SKIP_PRECISION_QUEUE_STEP_8],
        [SKIP_PRECISION_QUEUE_STEP_9],
        [SKIP_PRECISION_QUEUE_STEP_10],
        [REPORTING_HALF_HOUR],
        [REPORTING_INTERVAL],
        1 AS [Row Count]
FROM    [dbo].[VW_PARTITIONED_SUM_ROUTER_QUEUE_INTERVAL] AS f
INNER JOIN [dbo].[TB_DIM_PRECISION_QUEUE] AS tdpq ON f.PRECISION_QUEUE_URN = [tdpq].[ITEM_URN]
INNER JOIN [dbo].[TB_DIM_PRECISION_QUEUE_PKEY_MAP] AS d ON [tdpq].[ITEM_BIZ_URN] = [d].[ITEM_BIZ_URN]
                                                           AND d.[LATEST] = 1;
GO
GRANT SELECT
	ON [dbo].[VW_SUM_ROUTER_QUEUE_INTERVAL]
	TO [portalreporting_role]
GO
