SET ANSI_NULLS ON
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[Call_Type_Interval]
AS
SELECT  [callTypeInterval].[DATE_TIME] AS DateTime,
        CAST([callType].[PKEY1] AS INT) AS CallTypeID,
        [callTypeInterval].[TIME_ZONE] AS TimeZone,
        [callTypeInterval].[RECOVERY_KEY] AS RecoveryKey,
        [callTypeInterval].[ROUTER_QUEUE_WAIT_TIME] AS RouterQueueWaitTime,
        [callTypeInterval].[ROUTER_QUEUE_CALLS] AS RouterQueueCalls,
        [callTypeInterval].[AVG_ROUTER_DELAY_Q] AS AvgRouterDelayQ,
        [callTypeInterval].[ROUTER_CALLS_ABAND_Q] AS RouterCallsAbandQ,
        [callTypeInterval].[ROUTER_QUEUE_CALL_TYPE_LIMIT] AS RouterQueueCallTypeLimit,
        [callTypeInterval].[ROUTER_QUEUE_GLOBAL_LIMIT] AS RouterQueueGlobalLimit,
        [callTypeInterval].[CALLS_ROUTED] AS CallsRouted,
        [callTypeInterval].[ERROR_COUNT] AS ErrorCount,
        [callTypeInterval].[ICR_DEFAULT_ROUTED] AS ICRDefaultRouted,
        [callTypeInterval].[NETWORK_DEFAULT_ROUTED] AS NetworkDefaultRouted,
        [callTypeInterval].[RETURN_BUSY] AS ReturnBusy,
        [callTypeInterval].[RETURN_RING] AS ReturnRing,
        [callTypeInterval].[NETWORK_ANNOUNCEMENT] AS NetworkAnnouncement,
        [callTypeInterval].[ANSWER_WAIT_TIME] AS AnswerWaitTime,
        [callTypeInterval].[CALLS_HANDLED] AS CallsHandled,
        [callTypeInterval].[CALLS_OFFERED] AS CallsOffered,
        [callTypeInterval].[HANDLE_TIME] AS HandleTime,
        [callTypeInterval].[SERVICE_LEVEL_ABANDONED] AS ServiceLevelAband,
        [callTypeInterval].[SERVICE_LEVEL_CALLS] AS ServiceLevelCalls,
        [callTypeInterval].[SERVICE_LEVEL_CALLS_OFFERED] AS ServiceLevelCallsOffered,
        [callTypeInterval].[SERVICE_LEVEL] AS ServiceLevel,
        [callTypeInterval].[TALK_TIME] AS TalkTime,
        [callTypeInterval].[OVERFLOW_OUT] AS OverflowOut,
        [callTypeInterval].[HOLD_TIME] AS HoldTime,
        [callTypeInterval].[INCOMPLETE_CALLS] AS IncompleteCalls,
        [callTypeInterval].[SHORT_CALLS] AS ShortCalls,
        [callTypeInterval].[DELAY_QUEUE_ABANDON_TIME] AS DelayQAbandTime,
        [callTypeInterval].[CALLS_ANSWERED] AS CallsAnswered,
        [callTypeInterval].[CALLS_ROUTED_NON_AGENT] AS CallsRoutedNonAgent,
        [callTypeInterval].[CALLS_RONA] AS CallsRONA,
        [callTypeInterval].[RETURN_RELEASE] AS ReturnRelease,
        [callTypeInterval].[CALLS_Q_HANDLED] AS CallsQHandled,
        [callTypeInterval].[VRU_UNHANDLED_CALLS] AS VruUnhandledCalls,
        [callTypeInterval].[VRU_HANDLED_CALLS] AS VruHandledCalls,
        [callTypeInterval].[VRU_ASSISTED_CALLS] AS VruAssistedCalls,
        [callTypeInterval].[VRU_OPT_OUT_UNHANDLED_CALLS] AS VruOptOutUnhandledCalls,
        [callTypeInterval].[VRU_SCRIPTED_XFERRED_CALLS] AS VruScriptedXferredCalls,
        [callTypeInterval].[VRU_FORCED_XFERRED_CALLS] AS VruForcedXferredCalls,
        [callTypeInterval].[VRU_OTHER_CALLS] AS VruOtherCalls,
        [callTypeInterval].[SERVICE_LEVEL_TYPE] AS ServiceLevelType,
        CAST([bucketInterval].[PKEY1] AS INT) AS BucketIntervalID,
        [callTypeInterval].[ANS_INTERVAL_1] AS AnsInterval1,
        [callTypeInterval].[ANS_INTERVAL_2] AS AnsInterval2,
        [callTypeInterval].[ANS_INTERVAL_3] AS AnsInterval3,
        [callTypeInterval].[ANS_INTERVAL_4] AS AnsInterval4,
        [callTypeInterval].[ANS_INTERVAL_5] AS AnsInterval5,
        [callTypeInterval].[ANS_INTERVAL_6] AS AnsInterval6,
        [callTypeInterval].[ANS_INTERVAL_7] AS AnsInterval7,
        [callTypeInterval].[ANS_INTERVAL_8] AS AnsInterval8,
        [callTypeInterval].[ANS_INTERVAL_9] AS AnsInterval9,
        [callTypeInterval].[ANS_INTERVAL_10] AS AnsInterval10,
        [callTypeInterval].[ABAND_INTERVAL_1] AS AbandInterval1,
        [callTypeInterval].[ABAND_INTERVAL_2] AS AbandInterval2,
        [callTypeInterval].[ABAND_INTERVAL_3] AS AbandInterval3,
        [callTypeInterval].[ABAND_INTERVAL_4] AS AbandInterval4,
        [callTypeInterval].[ABAND_INTERVAL_5] AS AbandInterval5,
        [callTypeInterval].[ABAND_INTERVAL_6] AS AbandInterval6,
        [callTypeInterval].[ABAND_INTERVAL_7] AS AbandInterval7,
        [callTypeInterval].[ABAND_INTERVAL_8] AS AbandInterval8,
        [callTypeInterval].[ABAND_INTERVAL_9] AS AbandInterval9,
        [callTypeInterval].[ABAND_INTERVAL_10] AS AbandInterval10,
        [callTypeInterval].[CALLS_REQUERIED] AS CallsRequeried,
        [callTypeInterval].[DB_DATETIME] AS DbDateTime,
        [callTypeInterval].[ROUTER_CALLS_ABAND_TO_AGENT] AS RouterCallsAbandToAgent,
        [callTypeInterval].[TOTAL_CALLS_ABAND] AS TotalCallsAband,
        [callTypeInterval].[DELAY_AGENT_ABAND_TIME] AS DelayAgentAbandTime,
        [callTypeInterval].[CALL_DELAY_ABAND_TIME] AS CallDelayAbandTime,
        [callTypeInterval].[CT_DELAY_ABAND_TIME] AS CTDelayAbandTime,
        [callTypeInterval].[SERVICE_LEVEL_ERROR] AS ServiceLevelError,
        [callTypeInterval].[SERVICE_LEVEL_RONA] AS ServiceLevelRONA,
        [callTypeInterval].[AGENT_ERROR_COUNT] AS AgentErrorCount,
        [callTypeInterval].[VRU_TIME] AS VRUTime,
        [callTypeInterval].[CT_VRU_TIME] AS CTVRUTime,
        NULL AS Reserved1,
        NULL AS Reserved2,
        NULL AS Reserved3,
        NULL AS Reserved4,
        NULL AS Reserved5,
        [callTypeInterval].[CALLS_ON_HOLD] AS CallsOnHold,
        [callTypeInterval].[MAX_HOLD_TIME] AS MaxHoldTime,
        [callTypeInterval].[REPORTING_HALF_HOUR] AS ReportingHalfHour,
        [callTypeInterval].[REPORTING_INTERVAL] AS ReportingInterval
FROM    [dbo].[VW_PARTITIONED_SUM_CALL_TYPE_INTERVAL] callTypeInterval
JOIN    [dbo].[VW_DIM_CALL_TYPE_PKEY] callType WITH ( NOLOCK ) ON [callType].[ITEM_URN] = [callTypeInterval].[CALL_TYPE_URN]
LEFT JOIN [dbo].[VW_DIM_BUCKET_INTERVAL_PKEY] bucketInterval WITH ( NOLOCK ) ON [bucketInterval].[ITEM_URN] = [callTypeInterval].[BUCKET_INTERVAL_URN];
GO
