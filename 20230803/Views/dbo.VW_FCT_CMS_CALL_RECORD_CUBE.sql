SET ANSI_NULLS ON
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[VW_FCT_CMS_CALL_RECORD_CUBE]
AS
SELECT  [PARTITION_URN],
        [PARTITION_GLOBAL_URN],
        [PARTITION_ID],
        [ANS_AGENT_URN],
        [ORIG_AGENT_URN],
        [ACD_URN],
        [VDN_URN],
        [VDN2_URN],
        [VDN3_URN],
        [VDN4_URN],
        [VDN5_URN],
        [VDN6_URN],
        [VDN7_URN],
        [VDN8_URN],
        [VDN9_URN],
        [CWC1_URN],
        [CWC2_URN],
        [CWC3_URN],
        [CWC4_URN],
        [CWC5_URN],
        [CALLING_PARTY_URN],
        [DIALED_NUM_URN],
        [CALLID_URN],
        [TRUNKGROUP_URN],
        [VECTOR_URN],
        [DISP_VDN_URN],
        [DISP_VECTOR_URN],
        [DISP_SKILLGROUP_URN],
        [SKILLGROUP1_URN] AS [SKILLGROUP_URN],
        [SKILLGROUP2_URN],
        [SKILLGROUP3_URN],
        [CLUSTER_RESOURCE_URN],
        [START_DATE_UTC_URN],
        [START_TIME_UTC_URN],
        [STOP_DATE_UTC_URN],
        [STOP_TIME_UTC_URN],
        tzd.[OLAP_DATETIME_UTC] AS [DATETIME_UTC_URN],
        tzd.[OLAP_DATETIME_TIMEZONE_0] AS [TIME_ZONE_0_URN],
        tzd.[OLAP_DATETIME_TIMEZONE_1] AS [TIME_ZONE_1_URN],
        tzd.[OLAP_DATETIME_TIMEZONE_2] AS [TIME_ZONE_2_URN],
        tzd.[OLAP_DATETIME_TIMEZONE_3] AS [TIME_ZONE_3_URN],
        tzd.[OLAP_DATETIME_TIMEZONE_4] AS [TIME_ZONE_4_URN],
        tzd.[OLAP_DATETIME_TIMEZONE_5] AS [TIME_ZONE_5_URN],
        tzd.[OLAP_DATETIME_TIMEZONE_6] AS [TIME_ZONE_6_URN],
        tzd.[OLAP_DATETIME_TIMEZONE_7] AS [TIME_ZONE_7_URN],
        tzd.[OLAP_DATETIME_TIMEZONE_8] AS [TIME_ZONE_8_URN],
        tzd.[OLAP_DATETIME_TIMEZONE_9] AS [TIME_ZONE_9_URN],
        tzd.[OLAP_DATETIME_TIMEZONE_10] AS [TIME_ZONE_10_URN],
        tzd.[OLAP_DATETIME_TIMEZONE_11] AS [TIME_ZONE_11_URN],
        tzd.[OLAP_DATETIME_TIMEZONE_12] AS [TIME_ZONE_12_URN],
        tzd.[OLAP_DATETIME_TIMEZONE_13] AS [TIME_ZONE_13_URN],
        tzd.[OLAP_DATETIME_TIMEZONE_14] AS [TIME_ZONE_14_URN],
        tzd.[OLAP_DATETIME_TIMEZONE_15] AS [TIME_ZONE_15_URN],
        tzd.[OLAP_DATETIME_TIMEZONE_16] AS [TIME_ZONE_16_URN],
        tzd.[OLAP_DATETIME_TIMEZONE_17] AS [TIME_ZONE_17_URN],
        tzd.[OLAP_DATETIME_TIMEZONE_18] AS [TIME_ZONE_18_URN],
        tzd.[OLAP_DATETIME_TIMEZONE_19] AS [TIME_ZONE_19_URN],
        -1 AS [FLEXIBLE_DIMENSION_0],
        -1 AS [FLEXIBLE_DIMENSION_1],
        -1 AS [FLEXIBLE_DIMENSION_2],
        -1 AS [FLEXIBLE_DIMENSION_3],
        -1 AS [FLEXIBLE_DIMENSION_4],
        CAST(ACW_TIME AS BIGINT) AS [Acw_Time],
        CAST(ANS_HOLD_TIME AS BIGINT) AS [Ans_Hold_Time],
        CAST(ASSIST AS BIGINT) AS [Assist],
        CAST(AUDIO AS BIGINT) AS [Audio],
        CAST(CONFERENCE AS BIGINT) AS [Conference],
        CAST(CONSULT_TIME AS BIGINT) AS [Consult_Time],
        CAST(DA_QUEUED AS BIGINT) AS [DA_Queued],
        CAST(DISPOSITION AS BIGINT) AS [Disposition],
        CAST(DURATION AS BIGINT) AS [Duration],
        CAST(HELD AS BIGINT) AS [Held],
        CAST(HOLD_ABN AS BIGINT) AS [Hold_Abn],
        CAST(MALICIOUS AS BIGINT) AS [Malicious],
        CAST(TALK_TIME AS BIGINT) AS [Talk_Time],
        CAST(TRANSFERRED AS BIGINT) AS [Transferred],
        CAST(AGT_RELEASED AS BIGINT) AS [Agt_Released],
        CAST(NET_IN_TIME AS BIGINT) AS [Net_in_Time],
        CAST(ORIG_HOLD_TIME AS BIGINT) AS [Orig_Hold_Time],
        CAST(QUEUE_TIME AS BIGINT) AS [Queue_Time],
        CAST(RING_TIME AS BIGINT) AS [Ring_Time],
        [Row Count] AS [Row Count]
FROM    [dbo].[VW_FCT_CMS_CALL_RECORD] x
JOIN    [dbo].[VW_DIM_TIME_STD_CUBE] t ON x.[START_TIME_UTC_URN] = t.[TIME_URN]
JOIN    [dbo].[TS_ADM_TIME_ZONE_DATA] tzd ON tzd.[DATE_UTC_URN] = x.[START_DATE_UTC_URN]
                                             AND tzd.[TIME_UTC_URN] = t.[QUARTER_HOUR_URN];
GO
GRANT SELECT
	ON [dbo].[VW_FCT_CMS_CALL_RECORD_CUBE]
	TO [portalapp_role]
GO
