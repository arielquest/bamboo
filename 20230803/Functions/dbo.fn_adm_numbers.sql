SET ANSI_NULLS ON
SET QUOTED_IDENTIFIER ON
GO
CREATE FUNCTION [dbo].[fn_adm_numbers]
    (
      @ZeroBased BIT,
      @MaxNumber BIGINT
    )
RETURNS TABLE
    WITH SCHEMABINDING
AS 
 RETURN
    WITH    [256] ( [N] )
              AS ( SELECT   1
                   FROM     ( VALUES ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), 
                                     ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), 
                                     ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), 
                                     ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), 
                                     ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), 
                                     ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), 
                                     ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), 
                                     ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), 
                                     ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), 
                                     ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), 
                                     ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), 
                                     ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), 
                                     ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), 
                                     ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), 
                                     ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1),
                                     ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), 
                                     ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), 
                                     ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), ( 1), 
                                     ( 1), ( 1), ( 1), ( 1)
                            ) [a] ( [N] )
                 ),
            [65536] ( [N] )
              AS ( SELECT   1
                   FROM     [256] [a]
                   CROSS JOIN [256] [b]
                 ),
            [4294967296] ( [N] )
              AS ( SELECT   1
                   FROM     [65536] [a]
                   CROSS JOIN [65536] [b]
                 )
    SELECT  [N] = 0
    -- IF WE DON'T WANT A ZERO BASED NUMBERS TABLE, THIS PREDICATE WILL FILTER OUT THE "0" ROW
    WHERE   @ZeroBased = 1
    UNION ALL
    -- 4,294,967,296 IS THE MAX NUMBER THAT CAN BE GENERATED, MAX INT IS "ONLY" 2,147,483,647
    -- SO IF THIS FUNCTION DOESN'T GIVE US ENOUGH NUMBERS, WE'RE DOING SOMETHING WRONG.
    SELECT TOP ( @MaxNumber )
            [N] = ROW_NUMBER() OVER ( ORDER BY [a].[N] )
    FROM    [4294967296] [a];
GO
